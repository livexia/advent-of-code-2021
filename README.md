# advent-of-code-2021

## 记录

**Day 14**：

最初的想法是将规则存入一个HashMap，而将聚合物存入列表。对于每一次聚合，遍历聚合物的两个元素，根据元素从规则中找到新的三个聚合元素，并存入新的聚合物列表，遍历结束后再将新的聚合物列表替换原有的聚合物列表。

**复杂度分析：** 这个实现方式的效率极低，因为每次遍历的次数都是前一次的两倍，实际上是一个指数级的增长。那么对于N个元素，M次聚合，第N次需要至少遍历2^n个元素，总共的复杂度应该是 O(M*2^N)。

在无法快速取得结果后，我尝试观察每一次的结果，而花了大量的时间尝试寻找其中的规律。最后我只好求助于社区的答案，于是在twitter上找到了 [dcreemer/adventofcode](https://github.com/dcreemer/adventofcode) 的答案。我根据我看到的解决办法，利用 Rust 写了新的答案。

同样是将规则存入HashMap，但是这次以键是聚合物对，值是聚合物对出现的次数，将聚合物存入HashMap。对于每一次聚合，新建一个与聚合物相同的HashMap，遍历聚合物的两个元素，也就是一个聚合对，根据规则实际上一个聚合对在一次聚合之后，会生成两个新的聚合，那么新生成的两个聚合对的次数也就是旧友聚合对的次数，将新的聚合对和次数存入新的HashMap。每次聚合结束之后，再替换旧的聚合物HashMap为新的HashMap。

**复杂度分析：** 对于输入，总有10个元素，那么总共有100个元素对，对于每次聚合，元素对的总数不变，也就是只需要进行200次的HashMap插入操作。那么对于N个元素，M次聚合，总共的复杂度应该是 O(MN^2) 。这个方法的复杂度较我自己的方法是一个指数时间和二次时间的差别。

**对于计数的复杂度分析：** 利用一个键为元素，值为个数的HashMap来对元素对出现次数进行统计，对于每一次聚合中的每一个聚合对，实际上只是增加了一个元素，那么在这时对HashMap的元素次数加一即可。总共进行 O(2^N) 次HashMap次数更新。

**Day 15**:

使用 Dijkstra 算法。使用 BinaryHeap 和 Reverse 实现一个最小堆，加快遍历速度。

参考：https://oi-wiki.org/graph/shortest-path/#dijkstra

**Day 17**:

花了很多时间尝试推导出初始速度的范围，~~但是实际上暴力就可以解决了~~，需要进行裁切，具体裁切的过程和分析请看代码注释。（物理的知识完全没有记住）

的确物理知识有些忘记了，但是题目中的探针实际上在每一个单一方向上并不是匀变速直线运动，所以不能使用匀变速直线运动的规律来确定速度范围。

**考虑x方向上的初始速度范围：**

当x方向上的速度减小到0时，还无法进入x的范围时，该初始速度无论如何无法达到目标范围。
**也就是所在x方向上，对于每一个特定的初始速度，总有一个探针能在x方向上行进的最大距离。**
当这个最大距离小于目标范围时，该初始速度一定无法使探针进入目标区域。
当x方向速度为0的时候，设x方向的初始速度为v，经过每一步速度减少1，那么总共经过v步速度为0。
那么实际上当x方向速度为0时，每一步经过的距离是公差为-1的等差数列。
所以x方向上探针经过的距离为 (v * v + v) / 2，设为s。
那么对于任意的v，假如s小于目标区域的最小的x范围，该速度v无论如何无法达到目标范围。
实际上就是求解 (v * v + v) / 2 >= x_min 这样一个一元二次不等式。
当x方向上的速度大于x的最大范围时，1步之后，探针就超出了x的目标范围。
那么x方向上的最大速度为x的最大范围。

**考虑y方向上的初始速度范围：**

因为初始位置不在区域范围内，所以至少需要1步 才能使探针在y方向的范围内。
无论探针初始速度是向上的还是向下的，那么最后总是需要以y向下的速度进入目标区域，因为目标区域在y=0之下。
**当探针从y=0或者经过y=0向下运动时，每一步经过的距离实际上是以公差为1的等差数列。**
所以在y向下的方向上，实际上不存在探针能探索的最大距离，与x方向不同。
那么即使当y=0的时候，x方向的速度为0，且x在目标范围内，探针一定能进入目标区域。
所以对于y方向，探针存在一个最大的同向、反向速度，但是不存在最小的同向、反向速度。

事实上对于一个特定的x方向的初始速度，存在一个时间范围，在这个时间范围内，探针能保证探针的x位置是位于目标范围内
那么理论上就可以根据这个时间范围和y的目标范围，推论出y的初始速度范围，**需要增加运算复杂度，在此可以不看**。

考虑初始时y向下的大最大初始速度，也就是不论方向的最小初始速度
设y方向的范围为y1..y2，且y1 < y2, y2 < 0
那么当y方向的速度为 y1 - 1 的时候，只需要1步，探针就已经超出了y方向的范围
所以y方向的最小初始速度(同方向的最大速度)是 y1

考虑y方向的最大初始速度，这个时候探针应当是做向上的抛物线运动
那么探针会两次经过 y = 0 的位置
而第二次经过时探针y方向的速度应当与初始y方向的速度大小相同、方向相反，记为 v0'
假设第二次经过 y = 0，之后至少需要1步才能进入目标范围
那么当 v0' > y1 的时候只需要1步探针就超出了y方向的范围
故 y 的最大初始速度(反方向最大速度)应该是 -v0，也就是 -y1

**可以看见实际上无论初始速度是向上还是向下的，最大的初始速度数值是一致的**。